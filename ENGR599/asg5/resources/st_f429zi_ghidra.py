# Add symbols for STM32F429ZI ARM Cortex-M4-based microcontroller
#
# This script defines entry point symbols, and should be run *before* any
# auto-analysis. In addition, at the time of program import, At the time of
# import, 'Apply Processor Defined Labels' and 'Anchor Processor Defined
# Labels' should be de-selected to avoid conflict with any of the default
# Cortex interrupt vector definitions.
#
# This script has several configurable parameters that represent multiple
# potential variabilities in system configurations. These parameters should be
# set appropriately before the script is run.
# 
#@category Analysis.STM32
#@author Austin Roach <ahroach@gmail.com>

# Interrupt vector base address is set to 0x0 at boot, but can be
# re-assigned by writing to the VTOR register. See Section 2.3.4
# 'Vector table' of PM0214: 'STM32F3 Series, STM32F4 Series, STM32L4 Series and
# STM32L4+ Series Cortex-M4 programming manual' for details
IV_base = 0x8000000

# Parameter that decides what address should be byte mapped to address 0.
# Within the processor, the memory-mapping configuration is controlled at boot
# time by the state of the BOOT pins,[1] and can be later reconfigured by
# writing to the SYSCFG_MEMRMP register.[2] This parameter could also be set to
# None if you don't want to map any memory region to address 0, for example in
# the case that that the interrupt vectors are defined at the start of flash
# and all pointers are contained within the flash region and you just don't
# want to deal with the 0x0 memory space.
# [1] Section 2.4: 'Boot Configuration' of RM0090 Rev. 17: 'STM32F405/415,
# STM32F407/417, STM32F427/437 and STM32F429/439 advanced Arm-based 32-bit MCUs
# Reference Manual' 
# [2] Section 9.2.1: 'SYSCFG memory remap (SYSCFG_MEMRMP)' of RM0090 Rev. 17:
# 'STM32F405/415, STM32F407/417, STM32F427/437 and STM32F429/439 advanced
# Arm-based 32-bit MCUs Reference Manual' 
byte_map_src_addr = 0x8000000

# Interrupt vectors defined in Section 12.2: 'External interrupt/event
# controller' of RM0090 Rev. 17: 'STM32F405/415, STM32F407/417, STM32F427/437
# and STM32F429/439 advanced Arm-based 32-bit MCUs Reference Manual' Interrupt
# vector addresses are relative to IV_base, defined above
IVs = \
[[0x004, "Reset"],
[0x008, "NMI"],
[0x00c, "HardFault"],
[0x010, "MemManage"],
[0x014, "BusFault"],
[0x018, "UsageFault"],
[0x02c, "SVCall"],
[0x030, "Debug_Monitor"],
[0x038, "PendSV"],
[0x03c, "Systick"],
[0x040, "WWDG"],
[0x044, "PVD"],
[0x048, "TAMP_STAMP"],
[0x04c, "RTC_WKUP"],
[0x050, "FLASH"],
[0x054, "RCC"],
[0x058, "EXTI0"],
[0x05c, "EXTI1"],
[0x060, "EXTI2"],
[0x064, "EXTI3"],
[0x068, "EXTI4"],
[0x06c, "DMA1_Stream0"],
[0x070, "DMA1_Stream1"],
[0x074, "DMA1_Stream2"],
[0x078, "DMA1_Stream3"],
[0x07c, "DMA1_Stream4"],
[0x080, "DMA1_Stream5"],
[0x084, "DMA1_Stream6"],
[0x088, "ADC"],
[0x08c, "CAN1_TX"],
[0x090, "CAN1_RX0"],
[0x094, "CAN1_RX1"],
[0x098, "CAN1_SCE"],
[0x09c, "EXTI9_5"],
[0x0a0, "TIM1_BRK_TIM9"],
[0x0a4, "TIM1_UP_TIM10"],
[0x0a8, "TIM1_TRG_COM_TIM11"],
[0x0ac, "TIM1_CC"],
[0x0b0, "TIM2"],
[0x0b4, "TIM3"],
[0x0b8, "TIM4"],
[0x0bc, "I2C1_EV"],
[0x0c0, "I2C1_ER"],
[0x0c4, "I2C2_EV"],
[0x0c8, "I2C2_ER"],
[0x0cc, "SPI1"],
[0x0d0, "SPI2"],
[0x0d4, "USART1"],
[0x0d8, "USART2"],
[0x0dc, "USART3"],
[0x0e0, "EXTI15_10"],
[0x0e4, "RTC_Alarm"],
[0x0e8, "OTG_FS_WKUP"],
[0x0ec, "TIM8_BRK_TIM12"],
[0x0f0, "TIM8_UP_TIM13"],
[0x0f4, "TIM8_TRG_COM_TIM14"],
[0x0f8, "TIM8_CC"],
[0x0fc, "DMA1_Stream7"],
[0x100, "FSMC"],
[0x104, "SDIO"],
[0x108, "TIM5"],
[0x10c, "SPI3"],
[0x110, "UART4"],
[0x114, "UART5"],
[0x118, "TIM6_DAC"],
[0x11c, "TIM7"],
[0x120, "DMA2_Stream0"],
[0x124, "DMA2_Stream1"],
[0x128, "DMA2_Stream2"],
[0x12c, "DMA2_Stream3"],
[0x130, "DMA2_Stream4"],
[0x134, "ETH"],
[0x138, "ETH_WKUP"],
[0x13c, "CAN2_TX"],
[0x140, "CAN2_RX0"],
[0x144, "CAN2_RX1"],
[0x148, "CAN2_SCE"],
[0x14c, "OTG_FS"],
[0x150, "DMA2_Stream5"],
[0x154, "DMA2_Stream6"],
[0x158, "DMA2_Stream7"],
[0x015c, "USART6"],
[0x160, "I2C3_EV"],
[0x164, "I2C3_ER"],
[0x168, "OTG_HS_EP1_OUT"],
[0x16c, "OTG_HS_EP1_IN"],
[0x170, "OTG_HS_WKUP"],
[0x174, "OTG_HS"],
[0x178, "DCMI"],
[0x17c, "CRYP"],
[0x180, "HASH_RNG"],
[0x184, "FPU"],
[0x188, "UART7"],
[0x18c, "UART8"],
[0x190, "SPI4"],
[0x194, "SPI5"],
[0x198, "SPI6"],
[0x19c, "SAI1"],
[0x1a0, "LCD-TFT"],
[0x1a4, "LCD-TFT-ERR"],
[0x1a8, "DMA2D"]]

mmio_syms = \
[[0x40000000, "TIM2_CR1"],
[0x40000004, "TIM2_CR2"],
[0x40000008, "TIM2_SMCR"],
[0x4000000c, "TIM2_DIER"],
[0x40000010, "TIM2_SR"],
[0x40000014, "TIM2_EGR"],
[0x40000018, "TIM2_CCMR1"],
[0x4000001c, "TIM2_CCMR2"],
[0x40000020, "TIM2_CCER"],
[0x40000028, "TIM2_PSC"],
[0x4000002c, "TIM2_ARR"],
[0x40000034, "TIM2_CCR1"],
[0x40000038, "TIM2_CCR2"],
[0x4000003c, "TIM2_CCR3"],
[0x40000040, "TIM2_CCR4"],
[0x40000048, "TIM2_DCR"],
[0x4000004c, "TIM2_DMAR"],
[0x40000050, "TIM2_OR"],
[0x40000400, "TIM3_CR1"],
[0x40000404, "TIM3_CR2"],
[0x40000408, "TIM3_SMCR"],
[0x4000040c, "TIM3_DIER"],
[0x40000410, "TIM3_SR"],
[0x40000414, "TIM3_EGR"],
[0x40000418, "TIM3_CCMR1"],
[0x4000041c, "TIM3_CCMR2"],
[0x40000420, "TIM3_CCER"],
[0x40000428, "TIM3_PSC"],
[0x4000042c, "TIM3_ARR"],
[0x40000434, "TIM3_CCR1"],
[0x40000438, "TIM3_CCR2"],
[0x4000043c, "TIM3_CCR3"],
[0x40000440, "TIM3_CCR4"],
[0x40000448, "TIM3_DCR"],
[0x4000044c, "TIM3_DMAR"],
[0x40000800, "TIM4_CR1"],
[0x40000804, "TIM4_CR2"],
[0x40000808, "TIM4_SMCR"],
[0x4000080c, "TIM4_DIER"],
[0x40000810, "TIM4_SR"],
[0x40000814, "TIM4_EGR"],
[0x40000818, "TIM4_CCMR1"],
[0x4000081c, "TIM4_CCMR2"],
[0x40000820, "TIM4_CCER"],
[0x40000828, "TIM4_PSC"],
[0x4000082c, "TIM4_ARR"],
[0x40000834, "TIM4_CCR1"],
[0x40000838, "TIM4_CCR2"],
[0x4000083c, "TIM4_CCR3"],
[0x40000840, "TIM4_CCR4"],
[0x40000848, "TIM4_DCR"],
[0x4000084c, "TIM4_DMAR"],
[0x40000c00, "TIM5_CR1"],
[0x40000c04, "TIM5_CR2"],
[0x40000c08, "TIM5_SMCR"],
[0x40000c0c, "TIM5_DIER"],
[0x40000c10, "TIM5_SR"],
[0x40000c14, "TIM5_EGR"],
[0x40000c18, "TIM5_CCMR1"],
[0x40000c1c, "TIM5_CCMR2"],
[0x40000c20, "TIM5_CCER"],
[0x40000c28, "TIM5_PSC"],
[0x40000c2c, "TIM5_ARR"],
[0x40000c34, "TIM5_CCR1"],
[0x40000c38, "TIM5_CCR2"],
[0x40000c3c, "TIM5_CCR3"],
[0x40000c40, "TIM5_CCR4"],
[0x40000c48, "TIM5_DCR"],
[0x40000c4c, "TIM5_DMAR"],
[0x40000c50, "TIM5_OR"],
[0x40001000, "TIM6_CR1"],
[0x40001004, "TIM6_CR2"],
[0x4000100c, "TIM6_DIER"],
[0x40001010, "TIM6_SR"],
[0x40001014, "TIM6_EGR"],
[0x40001024, "TIM6_CNT"],
[0x40001028, "TIM6_PSC"],
[0x4000102c, "TIM6_ARR"],
[0x40001400, "TIM7_CR1"],
[0x40001404, "TIM7_CR2"],
[0x4000140c, "TIM7_DIER"],
[0x40001410, "TIM7_SR"],
[0x40001414, "TIM7_EGR"],
[0x40001424, "TIM7_CNT"],
[0x40001428, "TIM7_PSC"],
[0x4000142c, "TIM7_ARR"],
[0x40001800, "TIM12_CR1"],
[0x40001808, "TIM12_SMCR"],
[0x4000180c, "TIM12_DIER"],
[0x40001810, "TIM12_SR"],
[0x40001814, "TIM12_EGR"],
[0x40001818, "TIM12_CCMR1"],
[0x40001820, "TIM12_CCER"],
[0x40001824, "TIM12_CNT"],
[0x40001828, "TIM12_PSC"],
[0x4000182c, "TIM12_ARR"],
[0x40001834, "TIM12_CCR1"],
[0x40001838, "TIM12_CCR2"],
[0x40001c00, "TIM13_CR1"],
[0x40001c08, "TIM13_SMCR"],
[0x40001c0c, "TIM13_DIER"],
[0x40001c10, "TIM13_SR"],
[0x40001c14, "TIM13_EGR"],
[0x40001c18, "TIM13_CCMR1"],
[0x40001c20, "TIM13_CCER"],
[0x40001c24, "TIM13_CNT"],
[0x40001c28, "TIM13_PSC"],
[0x40001c34, "TIM13_CCR1"],
[0x40001c50, "TIM13_OR"],
[0x40002000, "TIM14_CR1"],
[0x40002008, "TIM14_SMCR"],
[0x4000200c, "TIM14_DIER"],
[0x40002010, "TIM14_SR"],
[0x40002014, "TIM14_EGR"],
[0x40002018, "TIM14_CCMR1"],
[0x40002020, "TIM14_CCER"],
[0x40002024, "TIM14_CNT"],
[0x40002028, "TIM14_PSC"],
[0x40002034, "TIM14_CCR1"],
[0x40002050, "TIM14_OR"],
[0x40002800, "RTC_TR"],
[0x40002804, "RTC_DR"],
[0x40002808, "RTC_CR"],
[0x4000280c, "RTC_ISR"],
[0x40002810, "RTC_PRER"],
[0x40002814, "RTC_WUTR"],
[0x40002818, "RTC_CALIBR"],
[0x4000281c, "RTC_ALRMAR"],
[0x40002820, "RTC_ALRMBR"],
[0x40002824, "RTC_WPR"],
[0x40002828, "RTC_SSR"],
[0x4000282c, "RTC_SHIFTR"],
[0x40002830, "RTC_TSTR"],
[0x40002838, "RTC_TSSSR"],
[0x4000283c, "RTC_CALR"],
[0x40002840, "RTC_TAFCR"],
[0x40002844, "RTC_ALRMASSR"],
[0x40002848, "RTC_ALRMBSSR"],
[0x40002850, "RTC_BKP0R"],
[0x40002854, "RTC_BKP1R"],
[0x40002858, "RTC_BKP2R"],
[0x4000285c, "RTC_BKP3R"],
[0x40002860, "RTC_BKP4R"],
[0x40002864, "RTC_BKP5R"],
[0x40002868, "RTC_BKP6R"],
[0x4000286c, "RTC_BKP7R"],
[0x40002870, "RTC_BKP8R"],
[0x40002874, "RTC_BKP9R"],
[0x40002878, "RTC_BKP10R"],
[0x4000287c, "RTC_BKP11R"],
[0x40002880, "RTC_BKP12R"],
[0x40002884, "RTC_BKP13R"],
[0x40002888, "RTC_BKP14R"],
[0x4000288c, "RTC_BKP15R"],
[0x40002890, "RTC_BKP16R"],
[0x40002894, "RTC_BKP17R"],
[0x40002898, "RTC_BKP18R"],
[0x4000289c, "RTC_BKP19R"],
[0x40002c00, "WWDG_CR"],
[0x40002c04, "WWDG_CFR"],
[0x40002c08, "WWDG_SR"],
[0x40003000, "IWDG_KR"],
[0x40003004, "IWDG_PR"],
[0x40003008, "IWDG_RLR"],
[0x4000300c, "IWDG_SR"],
[0x40003400, "I2S2EXT"],
[0x40003800, "SPI2_CR1"],
[0x40003804, "SPI2_CR2"],
[0x40003808, "SPI2_SR"],
[0x4000380c, "SPI2_DR"],
[0x40003810, "SPI2_CRCPR"],
[0x40003814, "SPI2_RXCRCR"],
[0x4000381c, "SPI2_I2SCFGR"],
[0x40003820, "SPI2_I2SPR"],
[0x40003c00, "SPI3_CR1"],
[0x40003c04, "SPI3_CR2"],
[0x40003c08, "SPI3_SR"],
[0x40003c0c, "SPI3_DR"],
[0x40003c10, "SPI3_CRCPR"],
[0x40003c14, "SPI3_RXCRCR"],
[0x40003c1c, "SPI3_I2SCFGR"],
[0x40003c20, "SPI3_I2SPR"],
[0x40004000, "I2S3EXT"],
[0x40004400, "USART2_SR"],
[0x40004404, "USART2_DR"],
[0x40004408, "USART2_BRR"],
[0x4000440c, "USART2_CR1"],
[0x40004410, "USART2_CR2"],
[0x40004414, "USART2_CR3"],
[0x40004418, "USART2_GTPR"],
[0x40004800, "USART3_SR"],
[0x40004804, "USART3_DR"],
[0x40004808, "USART3_BRR"],
[0x4000480c, "USART3_CR1"],
[0x40004810, "USART3_CR2"],
[0x40004814, "USART3_CR3"],
[0x40004818, "USART3_GTPR"],
[0x40004c00, "UART4_SR"],
[0x40004c04, "UART4_DR"],
[0x40004c08, "UART4_BRR"],
[0x40004c0c, "UART4_CR1"],
[0x40004c10, "UART4_CR2"],
[0x40004c14, "UART4_CR3"],
[0x40004c18, "UART4_GTPR"],
[0x40005000, "UART5_SR"],
[0x40005004, "UART5_DR"],
[0x40005008, "UART5_BRR"],
[0x4000500c, "UART5_CR1"],
[0x40005010, "UART5_CR2"],
[0x40005014, "UART5_CR3"],
[0x40005018, "UART5_GTPR"],
[0x40005400, "I2C1_CR1"],
[0x40005404, "I2C1_CR2"],
[0x40005408, "I2C1_OAR1"],
[0x4000540c, "I2C1_OAR2"],
[0x40005410, "I2C1_DR"],
[0x40005414, "I2C1_SR1"],
[0x40005418, "I2C1_SR2"],
[0x40005420, "I2C1_TRISE"],
[0x40005424, "I2C1_FLTR"],
[0x40005800, "I2C2_CR1"],
[0x40005804, "I2C2_CR2"],
[0x40005808, "I2C2_OAR1"],
[0x4000580c, "I2C2_OAR2"],
[0x40005810, "I2C2_DR"],
[0x40005814, "I2C2_SR1"],
[0x40005818, "I2C2_SR2"],
[0x40005820, "I2C2_TRISE"],
[0x40005824, "I2C2_FLTR"],
[0x40005c00, "I2C3_CR1"],
[0x40005c04, "I2C3_CR2"],
[0x40005c08, "I2C3_OAR1"],
[0x40005c0c, "I2C3_OAR2"],
[0x40005c10, "I2C3_DR"],
[0x40005c14, "I2C3_SR1"],
[0x40005c18, "I2C3_SR2"],
[0x40005c20, "I2C3_TRISE"],
[0x40005c24, "I2C3_FLTR"],
[0x40006400, "CAN1_MCR"],
[0x40006404, "CAN1_MSR"],
[0x40006408, "CAN1_TSR"],
[0x4000640c, "CAN1_RF0R"],
[0x40006410, "CAN1_RF1R"],
[0x40006414, "CAN1_IER"],
[0x40006418, "CAN1_ESR"],
[0x4000641c, "CAN1_BTR"],
[0x40006580, "CAN1_TI0R"],
[0x40006584, "CAN1_TDT0R"],
[0x40006588, "CAN1_TDL0R"],
[0x4000658c, "CAN1_TDH0R"],
[0x40006590, "CAN1_TI1R"],
[0x40006590, "CAN1_TDT1R"],
[0x40006598, "CAN1_TDL1R"],
[0x4000659c, "CAN1_TDH1R"],
[0x400065a0, "CAN1_TI2R"],
[0x400065a0, "CAN1_TDT2R"],
[0x400065a8, "CAN1_TDL2R"],
[0x400065ac, "CAN1_TDH2R"],
[0x400065b0, "CAN1_RI0R"],
[0x400065b4, "CAN1_RDT0R"],
[0x400065b8, "CAN1_RDL0R"],
[0x400065bc, "CAN1_RDH0R"],
[0x400065c0, "CAN1_RI1R"],
[0x400065c4, "CAN1_RDT1R"],
[0x400065c8, "CAN1_RDL1R"],
[0x400065cc, "CAN1_RDH1R"],
[0x40006600, "CAN1_FMR"],
[0x40006604, "CAN1_FM1R"],
[0x4000660c, "CAN1_FS1R"],
[0x40006614, "CAN1_FFA1R"],
[0x4000661c, "CAN1_FA1R"],
[0x40006640, "CAN1_F0R1"],
[0x40006644, "CAN1_F0R2"],
[0x40006648, "CAN1_F1R1"],
[0x4000664c, "CAN1_F1R2"],
[0x40006650, "CAN1_F2R1"],
[0x40006654, "CAN1_F2R2"],
[0x40006658, "CAN1_F3R1"],
[0x4000665c, "CAN1_F3R2"],
[0x40006660, "CAN1_F4R1"],
[0x40006664, "CAN1_F4R2"],
[0x40006668, "CAN1_F5R1"],
[0x4000666c, "CAN1_F5R2"],
[0x40006670, "CAN1_F6R1"],
[0x40006674, "CAN1_F6R2"],
[0x40006678, "CAN1_F7R1"],
[0x4000667c, "CAN1_F7R2"],
[0x40006680, "CAN1_F8R1"],
[0x40006684, "CAN1_F8R2"],
[0x40006688, "CAN1_F9R1"],
[0x4000668c, "CAN1_F9R2"],
[0x40006690, "CAN1_F10R1"],
[0x40006694, "CAN1_F10R2"],
[0x40006698, "CAN1_F11R1"],
[0x4000669c, "CAN1_F11R2"],
[0x400066a0, "CAN1_F12R1"],
[0x400066a4, "CAN1_F12R2"],
[0x400066a8, "CAN1_F13R1"],
[0x400066ac, "CAN1_F13R2"],
[0x400066b0, "CAN1_F14R1"],
[0x400066b4, "CAN1_F14R2"],
[0x400066b8, "CAN1_F15R1"],
[0x400066bc, "CAN1_F15R2"],
[0x400066c0, "CAN1_F16R1"],
[0x400066c4, "CAN1_F16R2"],
[0x400066c8, "CAN1_F17R1"],
[0x400066cc, "CAN1_F17R2"],
[0x400066d0, "CAN1_F18R1"],
[0x400066d4, "CAN1_F18R2"],
[0x400066d8, "CAN1_F19R1"],
[0x400066dc, "CAN1_F19R2"],
[0x400066e0, "CAN1_F20R1"],
[0x400066e4, "CAN1_F20R2"],
[0x400066e8, "CAN1_F21R1"],
[0x400066ec, "CAN1_F21R2"],
[0x400066f0, "CAN1_F22R1"],
[0x400066f4, "CAN1_F22R2"],
[0x400066f8, "CAN1_F23R1"],
[0x400066fc, "CAN1_F23R2"],
[0x40006700, "CAN1_F24R1"],
[0x40006704, "CAN1_F24R2"],
[0x40006708, "CAN1_F25R1"],
[0x4000670c, "CAN1_F25R2"],
[0x40006710, "CAN1_F26R1"],
[0x40006714, "CAN1_F26R2"],
[0x40006718, "CAN1_F27R1"],
[0x4000671c, "CAN1_F27R2"],
[0x40006800, "CAN2_MCR"],
[0x40006804, "CAN2_MSR"],
[0x40006808, "CAN2_TSR"],
[0x4000680c, "CAN2_RF0R"],
[0x40006810, "CAN2_RF1R"],
[0x40006814, "CAN2_IER"],
[0x40006818, "CAN2_ESR"],
[0x4000681c, "CAN2_BTR"],
[0x40006980, "CAN2_TI0R"],
[0x40006984, "CAN2_TDT0R"],
[0x40006988, "CAN2_TDL0R"],
[0x4000698c, "CAN2_TDH0R"],
[0x40006990, "CAN2_TI1R"],
[0x40006990, "CAN2_TDT1R"],
[0x40006998, "CAN2_TDL1R"],
[0x4000699c, "CAN2_TDH1R"],
[0x400069a0, "CAN2_TI2R"],
[0x400069a0, "CAN2_TDT2R"],
[0x400069a8, "CAN2_TDL2R"],
[0x400069ac, "CAN2_TDH2R"],
[0x400069b0, "CAN2_RI0R"],
[0x400069b4, "CAN2_RDT0R"],
[0x400069b8, "CAN2_RDL0R"],
[0x400069bc, "CAN2_RDH0R"],
[0x400069c0, "CAN2_RI1R"],
[0x400069c4, "CAN2_RDT1R"],
[0x400069c8, "CAN2_RDL1R"],
[0x400069cc, "CAN2_RDH1R"],
[0x40006a00, "CAN2_FMR"],
[0x40006a04, "CAN2_FM1R"],
[0x40006a0c, "CAN2_FS1R"],
[0x40006a14, "CAN2_FFA1R"],
[0x40006a1c, "CAN2_FA1R"],
[0x40006a40, "CAN2_F0R1"],
[0x40006a44, "CAN2_F0R2"],
[0x40006a48, "CAN2_F1R1"],
[0x40006a4c, "CAN2_F1R2"],
[0x40006a50, "CAN2_F2R1"],
[0x40006a54, "CAN2_F2R2"],
[0x40006a58, "CAN2_F3R1"],
[0x40006a5c, "CAN2_F3R2"],
[0x40006a60, "CAN2_F4R1"],
[0x40006a64, "CAN2_F4R2"],
[0x40006a68, "CAN2_F5R1"],
[0x40006a6c, "CAN2_F5R2"],
[0x40006a70, "CAN2_F6R1"],
[0x40006a74, "CAN2_F6R2"],
[0x40006a78, "CAN2_F7R1"],
[0x40006a7c, "CAN2_F7R2"],
[0x40006a80, "CAN2_F8R1"],
[0x40006a84, "CAN2_F8R2"],
[0x40006a88, "CAN2_F9R1"],
[0x40006a8c, "CAN2_F9R2"],
[0x40006a90, "CAN2_F10R1"],
[0x40006a94, "CAN2_F10R2"],
[0x40006a98, "CAN2_F11R1"],
[0x40006a9c, "CAN2_F11R2"],
[0x40006aa0, "CAN2_F12R1"],
[0x40006aa4, "CAN2_F12R2"],
[0x40006aa8, "CAN2_F13R1"],
[0x40006aac, "CAN2_F13R2"],
[0x40006ab0, "CAN2_F14R1"],
[0x40006ab4, "CAN2_F14R2"],
[0x40006ab8, "CAN2_F15R1"],
[0x40006abc, "CAN2_F15R2"],
[0x40006ac0, "CAN2_F16R1"],
[0x40006ac4, "CAN2_F16R2"],
[0x40006ac8, "CAN2_F17R1"],
[0x40006acc, "CAN2_F17R2"],
[0x40006ad0, "CAN2_F18R1"],
[0x40006ad4, "CAN2_F18R2"],
[0x40006ad8, "CAN2_F19R1"],
[0x40006adc, "CAN2_F19R2"],
[0x40006ae0, "CAN2_F20R1"],
[0x40006ae4, "CAN2_F20R2"],
[0x40006ae8, "CAN2_F21R1"],
[0x40006aec, "CAN2_F21R2"],
[0x40006af0, "CAN2_F22R1"],
[0x40006af4, "CAN2_F22R2"],
[0x40006af8, "CAN2_F23R1"],
[0x40006afc, "CAN2_F23R2"],
[0x40006b00, "CAN2_F24R1"],
[0x40006b04, "CAN2_F24R2"],
[0x40006b08, "CAN2_F25R1"],
[0x40006b0c, "CAN2_F25R2"],
[0x40006b10, "CAN2_F26R1"],
[0x40006b14, "CAN2_F26R2"],
[0x40006b18, "CAN2_F27R1"],
[0x40006b1c, "CAN2_F27R2"],
[0x40007000, "PWR_CR"],
[0x40007004, "PWR_CSR"],
[0x40007400, "DAC_CR"],
[0x40007404, "DAC_SWTRIGR"],
[0x40007408, "DAC_DHR12R1"],
[0x4000740c, "DAC_DHR12L1"],
[0x40007410, "DAC_DHR8R1"],
[0x40007414, "DAC_DHR12R2"],
[0x40007418, "DAC_DHR12L2"],
[0x4000741c, "DAC_DHR8R2"],
[0x40007420, "DAC_DHR12RD"],
[0x40007424, "DAC_DHR12LD"],
[0x40007428, "DAC_DHR8RD"],
[0x4000742c, "DAC_DOR1"],
[0x40007430, "DAC_DOR2"],
[0x40007434, "DAC_SR"],
[0x40007800, "UART7_SR"],
[0x40007804, "UART7_DR"],
[0x40007808, "UART7_BRR"],
[0x4000780c, "UART7_CR1"],
[0x40007810, "UART7_CR2"],
[0x40007814, "UART7_CR3"],
[0x40007818, "UART7_GTPR"],
[0x40007c00, "UART8_SR"],
[0x40007c04, "UART8_DR"],
[0x40007c08, "UART8_BRR"],
[0x40007c0c, "UART8_CR1"],
[0x40007c10, "UART8_CR2"],
[0x40007c14, "UART8_CR3"],
[0x40007c18, "UART8_GTPR"],
[0x40010000, "TIM1_CR1"],
[0x40010004, "TIM1_CR2"],
[0x40010008, "TIM1_SMCR"],
[0x4001000c, "TIM1_DIER"],
[0x40010010, "TIM1_SR"],
[0x40010014, "TIM1_EGR"],
[0x40010018, "TIM1_CCMR1"],
[0x4001001c, "TIM1_CCMR2"],
[0x40010020, "TIM1_CCER"],
[0x40010024, "TIM1_CNT"],
[0x40010028, "TIM1_PSC"],
[0x4001002c, "TIM1_ARR"],
[0x40010030, "TIM1_RCR"],
[0x40010034, "TIM1_CCR1"],
[0x40010038, "TIM1_CCR2"],
[0x4001003c, "TIM1_CCR3"],
[0x40010040, "TIM1_CCR4"],
[0x40010044, "TIM1_BDTR"],
[0x40010048, "TIM1_DCR"],
[0x4001004c, "TIM1_DMAR"],
[0x40010400, "TIM8_CR1"],
[0x40010404, "TIM8_CR2"],
[0x40010408, "TIM8_SMCR"],
[0x4001040c, "TIM8_DIER"],
[0x40010410, "TIM8_SR"],
[0x40010414, "TIM8_EGR"],
[0x40010418, "TIM8_CCMR1"],
[0x4001041c, "TIM8_CCMR2"],
[0x40010420, "TIM8_CCER"],
[0x40010424, "TIM8_CNT"],
[0x40010428, "TIM8_PSC"],
[0x4001042c, "TIM8_ARR"],
[0x40010430, "TIM8_RCR"],
[0x40010434, "TIM8_CCR1"],
[0x40010438, "TIM8_CCR2"],
[0x4001043c, "TIM8_CCR3"],
[0x40010440, "TIM8_CCR4"],
[0x40010444, "TIM8_BDTR"],
[0x40010448, "TIM8_DCR"],
[0x4001044c, "TIM8_DMAR"],
[0x40011000, "USART1_SR"],
[0x40011004, "USART1_DR"],
[0x40011008, "USART1_BRR"],
[0x4001100c, "USART1_CR1"],
[0x40011010, "USART1_CR2"],
[0x40011014, "USART1_CR3"],
[0x40011018, "USART1_GTPR"],
[0x40011400, "USART6_SR"],
[0x40011404, "USART6_DR"],
[0x40011408, "USART6_BRR"],
[0x4001140c, "USART6_CR1"],
[0x40011410, "USART6_CR2"],
[0x40011414, "USART6_CR3"],
[0x40011418, "USART6_GTPR"],
[0x40012300, "ADC_CSR"],
[0x40012304, "ADC_CCR"],
[0x40012308, "ADC_CDR"],
[0x40012000, "ADC1_SR"],
[0x40012004, "ADC1_CR1"],
[0x40012008, "ADC1_CR2"],
[0x4001200c, "ADC1_SMPR1"],
[0x40012010, "ADC1_SMPR2"],
[0x40012014, "ADC1_JOFR1"],
[0x40012018, "ADC1_JOFR2"],
[0x4001201c, "ADC1_JOFR3"],
[0x40012020, "ADC1_JOFR4"],
[0x40012024, "ADC1_HTR"],
[0x40012028, "ADC1_LTR"],
[0x4001202c, "ADC1_SQR1"],
[0x40012030, "ADC1_SQR2"],
[0x40012034, "ADC1_SQR3"],
[0x40012038, "ADC1_JSQR"],
[0x4001203c, "ADC1_JDR1"],
[0x40012040, "ADC1_JDR2"],
[0x40012044, "ADC1_JDR3"],
[0x40012048, "ADC1_JDR4"],
[0x4001204c, "ADC1_DR"],
[0x40012100, "ADC2_SR"],
[0x40012104, "ADC2_CR1"],
[0x40012108, "ADC2_CR2"],
[0x4001210c, "ADC2_SMPR1"],
[0x40012110, "ADC2_SMPR2"],
[0x40012114, "ADC2_JOFR1"],
[0x40012118, "ADC2_JOFR2"],
[0x4001211c, "ADC2_JOFR3"],
[0x40012120, "ADC2_JOFR4"],
[0x40012124, "ADC2_HTR"],
[0x40012128, "ADC2_LTR"],
[0x4001212c, "ADC2_SQR1"],
[0x40012130, "ADC2_SQR2"],
[0x40012134, "ADC2_SQR3"],
[0x40012138, "ADC2_JSQR"],
[0x4001213c, "ADC2_JDR1"],
[0x40012140, "ADC2_JDR2"],
[0x40012144, "ADC2_JDR3"],
[0x40012148, "ADC2_JDR4"],
[0x4001214c, "ADC2_DR"],
[0x40012200, "ADC3_SR"],
[0x40012204, "ADC3_CR1"],
[0x40012208, "ADC3_CR2"],
[0x4001220c, "ADC3_SMPR1"],
[0x40012210, "ADC3_SMPR2"],
[0x40012214, "ADC3_JOFR1"],
[0x40012218, "ADC3_JOFR2"],
[0x4001221c, "ADC3_JOFR3"],
[0x40012220, "ADC3_JOFR4"],
[0x40012224, "ADC3_HTR"],
[0x40012228, "ADC3_LTR"],
[0x4001222c, "ADC3_SQR1"],
[0x40012230, "ADC3_SQR2"],
[0x40012234, "ADC3_SQR3"],
[0x40012238, "ADC3_JSQR"],
[0x4001223c, "ADC3_JDR1"],
[0x40012240, "ADC3_JDR2"],
[0x40012244, "ADC3_JDR3"],
[0x40012248, "ADC3_JDR4"],
[0x4001224c, "ADC3_DR"],
[0x40012c00, "SDIO_POWER"],
[0x40012c04, "SDIO_CLKCR"],
[0x40012c08, "SDIO_ARG"],
[0x40012c0c, "SDIO_CMD"],
[0x40012c10, "SDIO_RSPCMD"],
[0x40012c14, "SDIO_RSP1"],
[0x40012c18, "SDIO_RSP2"],
[0x40012c1c, "SDIO_RSP3"],
[0x40012c20, "SDIO_RSP4"],
[0x40012c24, "SDIO_DTIMER"],
[0x40012c28, "SDIO_DLEN"],
[0x40012c2c, "SDIO_DCTRL"],
[0x40012c30, "SDIO_DCOUNT"],
[0x40012c34, "SDIO_STA"],
[0x40012c38, "SDIO_ICR"],
[0x40012c3c, "SDIO_MASK"],
[0x40012c48, "SDIO_FIFOCNT"],
[0x40012c80, "SDIO_FIFO"],
[0x40013000, "SPI1_CR1"],
[0x40013004, "SPI1_CR2"],
[0x40013008, "SPI1_SR"],
[0x4001300c, "SPI1_DR"],
[0x40013010, "SPI1_CRCPR"],
[0x40013014, "SPI1_RXCRCR"],
[0x4001301c, "SPI1_I2SCFGR"],
[0x40013020, "SPI1_I2SPR"],
[0x40013400, "SPI4_CR1"],
[0x40013404, "SPI4_CR2"],
[0x40013408, "SPI4_SR"],
[0x4001340c, "SPI4_DR"],
[0x40013410, "SPI4_CRCPR"],
[0x40013414, "SPI4_RXCRCR"],
[0x4001341c, "SPI4_I2SCFGR"],
[0x40013420, "SPI4_I2SPR"],
[0x40013800, "SYSCFG_MEMRMP"],
[0x40013804, "SYSCFG_PMC"],
[0x40013808, "SYSCFG_EXTICR1"],
[0x4001380c, "SYSCFG_EXTICR2"],
[0x40013810, "SYSCFG_EXTICR3"],
[0x40013814, "SYSCFG_EXTICR4"],
[0x40013820, "SYSCFG_CMPCR"],
[0x40013c00, "EXTI_IMR"],
[0x40013c04, "EXTI_EMR"],
[0x40013c08, "EXTI_RTSR"],
[0x40013c0c, "EXTI_FTSR"],
[0x40013c10, "EXTI_SWIER"],
[0x40013c14, "EXTI_PR"],
[0x40014000, "TIM9_CR1"],
[0x40014008, "TIM9_SMCR"],
[0x4001400c, "TIM9_DIER"],
[0x40014010, "TIM9_SR"],
[0x40014014, "TIM9_EGR"],
[0x40014018, "TIM9_CCMR1"],
[0x40014020, "TIM9_CCER"],
[0x40014024, "TIM9_CNT"],
[0x40014028, "TIM9_PSC"],
[0x4001402c, "TIM9_ARR"],
[0x40014034, "TIM9_CCR1"],
[0x40014038, "TIM9_CCR2"],
[0x40014400, "TIM10_CR1"],
[0x40014408, "TIM10_SMCR"],
[0x4001440c, "TIM10_DIER"],
[0x40014410, "TIM10_SR"],
[0x40014414, "TIM10_EGR"],
[0x40014418, "TIM10_CCMR1"],
[0x40014420, "TIM10_CCER"],
[0x40014424, "TIM10_CNT"],
[0x40014428, "TIM10_PSC"],
[0x40014434, "TIM10_CCR1"],
[0x40014450, "TIM10_OR"],
[0x40014800, "TIM11_CR1"],
[0x40014808, "TIM11_SMCR"],
[0x4001480c, "TIM11_DIER"],
[0x40014810, "TIM11_SR"],
[0x40014814, "TIM11_EGR"],
[0x40014818, "TIM11_CCMR1"],
[0x40014820, "TIM11_CCER"],
[0x40014824, "TIM11_CNT"],
[0x40014828, "TIM11_PSC"],
[0x40014834, "TIM11_CCR1"],
[0x40014850, "TIM11_OR"],
[0x40015000, "SPI5_CR1"],
[0x40015004, "SPI5_CR2"],
[0x40015008, "SPI5_SR"],
[0x4001500c, "SPI5_DR"],
[0x40015010, "SPI5_CRCPR"],
[0x40015014, "SPI5_RXCRCR"],
[0x4001501c, "SPI5_I2SCFGR"],
[0x40015020, "SPI5_I2SPR"],
[0x40015400, "SPI6_CR1"],
[0x40015404, "SPI6_CR2"],
[0x40015408, "SPI6_SR"],
[0x4001540c, "SPI6_DR"],
[0x40015410, "SPI6_CRCPR"],
[0x40015414, "SPI6_RXCRCR"],
[0x4001541c, "SPI6_I2SCFGR"],
[0x40015420, "SPI6_I2SPR"],
[0x40015804, "SAI_ACR1"],
[0x40015808, "SAI_ACR2"],
[0x4001580c, "SAI_AFRCR"],
[0x40015810, "SAI_ASLOTR"],
[0x40015814, "SAI_AIM"],
[0x40015818, "SAI_ASR"],
[0x4001581c, "SAI_ACLRFR"],
[0x40015820, "SAI_ADR"],
[0x40015824, "SAI_BCR1"],
[0x40015828, "SAI_BCR2"],
[0x4001582c, "SAI_BFRCR"],
[0x40015830, "SAI_BSLOTR"],
[0x40015834, "SAI_BIM"],
[0x40015838, "SAI_BSR"],
[0x4001583c, "SAI_BCLRFR"],
[0x40015840, "SAI_BDR"],
[0x40016808, "LTDC_SSCR"],
[0x4001680c, "LTDC_BPCR"],
[0x40016810, "LTDC_AWCR"],
[0x40016814, "LTDC_TWCR"],
[0x40016818, "LTDC_GCR"],
[0x40016824, "LTDC_SRCR"],
[0x4001682c, "LTDC_BCCR"],
[0x40016834, "LTDC_IER"],
[0x40016838, "LTDC_ISR"],
[0x4001683c, "LTDC_ICR"],
[0x40016840, "LTDC_LIPCR"],
[0x40016844, "LTDC_CPSR"],
[0x40016848, "LTDC_CDSR"],
[0x40016884, "LTDC_L1CR"],
[0x40016888, "LTDC_L1WHPCR"],
[0x4001688c, "LTDC_L1WVPCR"],
[0x40016890, "LTDC_L1CKCR"],
[0x40016894, "LTDC_L1PFCR"],
[0x40016898, "LTDC_L1CACR"],
[0x4001689c, "LTDC_L1DCCR"],
[0x400168a0, "LTDC_L1BFCR"],
[0x400168ac, "LTDC_L1CFBAR"],
[0x400168b0, "LTDC_L1CFBLR"],
[0x400168b4, "LTDC_L1CFBLNR"],
[0x400168c4, "LTDC_L1CLUTWR"],
[0x40016904, "LTDC_L2CR"],
[0x40016908, "LTDC_L2WHPCR"],
[0x4001690c, "LTDC_L2WVPCR"],
[0x40016910, "LTDC_L2CKCR"],
[0x40016914, "LTDC_L2PFCR"],
[0x40016918, "LTDC_L2CACR"],
[0x4001691c, "LTDC_L2DCCR"],
[0x40016920, "LTDC_L2BFCR"],
[0x4001692c, "LTDC_L2CFBAR"],
[0x40016930, "LTDC_L2CFBLR"],
[0x40016934, "LTDC_L2CFBLNR"],
[0x40016944, "LTDC_L2CLUTWR"],
[0x40020000, "GPIOA_MODER"],
[0x40020004, "GPIOA_OTYPER"],
[0x40020008, "GPIOA_OSPEEDR"],
[0x4002000c, "GPIOA_PUPDR"],
[0x40020010, "GPIOA_IDR"],
[0x40020014, "GPIOA_ODR"],
[0x40020018, "GPIOA_BSRR"],
[0x4002001c, "GPIOA_LCKR"],
[0x40020020, "GPIOA_AFRL"],
[0x40020024, "GPIOA_AFRH"],
[0x40020400, "GPIOB_MODER"],
[0x40020404, "GPIOB_OTYPER"],
[0x40020408, "GPIOB_OSPEEDR"],
[0x4002040c, "GPIOB_PUPDR"],
[0x40020410, "GPIOB_IDR"],
[0x40020414, "GPIOB_ODR"],
[0x40020418, "GPIOB_BSRR"],
[0x4002041c, "GPIOB_LCKR"],
[0x40020420, "GPIOB_AFRL"],
[0x40020424, "GPIOB_AFRH"],
[0x40020800, "GPIOC_MODER"],
[0x40020804, "GPIOC_OTYPER"],
[0x40020808, "GPIOC_OSPEEDR"],
[0x4002080c, "GPIOC_PUPDR"],
[0x40020810, "GPIOC_IDR"],
[0x40020814, "GPIOC_ODR"],
[0x40020818, "GPIOC_BSRR"],
[0x4002081c, "GPIOC_LCKR"],
[0x40020820, "GPIOC_AFRL"],
[0x40020824, "GPIOC_AFRH"],
[0x40020c00, "GPIOD_MODER"],
[0x40020c04, "GPIOD_OTYPER"],
[0x40020c08, "GPIOD_OSPEEDR"],
[0x40020c0c, "GPIOD_PUPDR"],
[0x40020c10, "GPIOD_IDR"],
[0x40020c14, "GPIOD_ODR"],
[0x40020c18, "GPIOD_BSRR"],
[0x40020c1c, "GPIOD_LCKR"],
[0x40020c20, "GPIOD_AFRL"],
[0x40020c24, "GPIOD_AFRH"],
[0x40021000, "GPIOE_MODER"],
[0x40021004, "GPIOE_OTYPER"],
[0x40021008, "GPIOE_OSPEEDR"],
[0x4002100c, "GPIOE_PUPDR"],
[0x40021010, "GPIOE_IDR"],
[0x40021014, "GPIOE_ODR"],
[0x40021018, "GPIOE_BSRR"],
[0x4002101c, "GPIOE_LCKR"],
[0x40021020, "GPIOE_AFRL"],
[0x40021024, "GPIOE_AFRH"],
[0x40021400, "GPIOF_MODER"],
[0x40021404, "GPIOF_OTYPER"],
[0x40021408, "GPIOF_OSPEEDR"],
[0x4002140c, "GPIOF_PUPDR"],
[0x40021410, "GPIOF_IDR"],
[0x40021414, "GPIOF_ODR"],
[0x40021418, "GPIOF_BSRR"],
[0x4002141c, "GPIOF_LCKR"],
[0x40021420, "GPIOF_AFRL"],
[0x40021424, "GPIOF_AFRH"],
[0x40021800, "GPIOG_MODER"],
[0x40021804, "GPIOG_OTYPER"],
[0x40021808, "GPIOG_OSPEEDR"],
[0x4002180c, "GPIOG_PUPDR"],
[0x40021810, "GPIOG_IDR"],
[0x40021814, "GPIOG_ODR"],
[0x40021818, "GPIOG_BSRR"],
[0x4002181c, "GPIOG_LCKR"],
[0x40021820, "GPIOG_AFRL"],
[0x40021824, "GPIOG_AFRH"],
[0x40021c00, "GPIOH_MODER"],
[0x40021c04, "GPIOH_OTYPER"],
[0x40021c08, "GPIOH_OSPEEDR"],
[0x40021c0c, "GPIOH_PUPDR"],
[0x40021c10, "GPIOH_IDR"],
[0x40021c14, "GPIOH_ODR"],
[0x40021c18, "GPIOH_BSRR"],
[0x40021c1c, "GPIOH_LCKR"],
[0x40021c20, "GPIOH_AFRL"],
[0x40021c24, "GPIOH_AFRH"],
[0x40022000, "GPIOI_MODER"],
[0x40022004, "GPIOI_OTYPER"],
[0x40022008, "GPIOI_OSPEEDR"],
[0x4002200c, "GPIOI_PUPDR"],
[0x40022010, "GPIOI_IDR"],
[0x40022014, "GPIOI_ODR"],
[0x40022018, "GPIOI_BSRR"],
[0x4002201c, "GPIOI_LCKR"],
[0x40022020, "GPIOI_AFRL"],
[0x40022024, "GPIOI_AFRH"],
[0x40022400, "GPIOJ_MODER"],
[0x40022404, "GPIOJ_OTYPER"],
[0x40022408, "GPIOJ_OSPEEDR"],
[0x4002240c, "GPIOJ_PUPDR"],
[0x40022410, "GPIOJ_IDR"],
[0x40022414, "GPIOJ_ODR"],
[0x40022418, "GPIOJ_BSRR"],
[0x4002241c, "GPIOJ_LCKR"],
[0x40022420, "GPIOJ_AFRL"],
[0x40022424, "GPIOJ_AFRH"],
[0x40022800, "GPIOK_MODER"],
[0x40022804, "GPIOK_OTYPER"],
[0x40022808, "GPIOK_OSPEEDR"],
[0x4002280c, "GPIOK_PUPDR"],
[0x40022810, "GPIOK_IDR"],
[0x40022814, "GPIOK_ODR"],
[0x40022818, "GPIOK_BSRR"],
[0x4002281c, "GPIOK_LCKR"],
[0x40022820, "GPIOK_AFRL"],
[0x40022824, "GPIOK_AFRH"],
[0x40023000, "CRC_DR"],
[0x40023004, "CRC_IDR"],
[0x40023008, "CRC_CR"],
[0x40023800, "RCC_CR"],
[0x40023804, "RCC_PLLCFGR"],
[0x40023808, "RCC_CFGR"],
[0x4002380c, "RCC_CIR"],
[0x40023810, "RCC_AHB1RSTR"],
[0x40023814, "RCC_AHB2RSTR"],
[0x40023818, "RCC_AHB3RSTR"],
[0x40023820, "RCC_APB1RSTR"],
[0x40023824, "RCC_APB2RSTR"],
[0x40023830, "RCC_AHB1ENR"],
[0x40023834, "RCC_AHB2ENR"],
[0x40023838, "RCC_AHB3ENR"],
[0x40023840, "RCC_APB1ENR"],
[0x40023844, "RCC_APB2ENR"],
[0x40023850, "RCC_AHB1LPENR"],
[0x40023854, "RCC_AHB2LPENR"],
[0x40023858, "RCC_AHB3LPENR"],
[0x40023860, "RCC_APB1LPENR"],
[0x40023864, "RCC_APB2LPENR"],
[0x40023870, "RCC_BDCR"],
[0x40023874, "RCC_CSR"],
[0x40023880, "RCC_SSCGR"],
[0x40023884, "RCC_PLLI2SCFGR"],
[0x40023c00, "FLASH_ACR"],
[0x40023c04, "FLASH_KEYR"],
[0x40023c08, "FLASH_OPTKEYR"],
[0x40023c0c, "FLASH_SR"],
[0x40023c10, "FLASH_CR"],
[0x40023c14, "FLASH_OPTCR"],
[0x40023c18, "FLASH_OPTCR1"],
[0x40024000, "BKPSRAM"],
[0x40026000, "DMA1_LISR"],
[0x40026004, "DMA1_HISR"],
[0x40026008, "DMA1_LIFCR"],
[0x4002600c, "DMA1_HIFCR"],
[0x40026010, "DMA1_S0CR"],
[0x40026014, "DMA1_S0NDTR"],
[0x40026018, "DMA1_S0PAR"],
[0x4002601c, "DMA1_S0M0AR"],
[0x40026020, "DMA1_S0M1AR"],
[0x40026024, "DMA1_S0FCR"],
[0x40026028, "DMA1_S1CR"],
[0x4002602c, "DMA1_S1NDTR"],
[0x40026030, "DMA1_S1PAR"],
[0x40026034, "DMA1_S1M0AR"],
[0x40026038, "DMA1_S1M1AR"],
[0x4002603c, "DMA1_S1FCR"],
[0x40026040, "DMA1_S2CR"],
[0x40026044, "DMA1_S2NDTR"],
[0x40026048, "DMA1_S2PAR"],
[0x4002604c, "DMA1_S2M0AR"],
[0x40026050, "DMA1_S2M1AR"],
[0x40026054, "DMA1_S2FCR"],
[0x40026058, "DMA1_S3CR"],
[0x4002605c, "DMA1_S3NDTR"],
[0x40026060, "DMA1_S3PAR"],
[0x40026064, "DMA1_S3M0AR"],
[0x40026068, "DMA1_S3M1AR"],
[0x4002606c, "DMA1_S3FCR"],
[0x40026070, "DMA1_S4CR"],
[0x40026074, "DMA1_S4NDTR"],
[0x40026078, "DMA1_S4PAR"],
[0x4002607c, "DMA1_S4M0AR"],
[0x40026080, "DMA1_S4M1AR"],
[0x40026084, "DMA1_S4FCR"],
[0x40026088, "DMA1_S5CR"],
[0x4002608c, "DMA1_S5NDTR"],
[0x40026090, "DMA1_S5PAR"],
[0x40026094, "DMA1_S5M0AR"],
[0x40026098, "DMA1_S5M1AR"],
[0x4002609c, "DMA1_S5FCR"],
[0x400260a0, "DMA1_S6CR"],
[0x400260a4, "DMA1_S6NDTR"],
[0x400260a8, "DMA1_S6PAR"],
[0x400260ac, "DMA1_S6M0AR"],
[0x400260b0, "DMA1_S6M1AR"],
[0x400260b4, "DMA1_S6FCR"],
[0x400260b8, "DMA1_S7CR"],
[0x400260bc, "DMA1_S7NDTR"],
[0x400260c0, "DMA1_S7PAR"],
[0x400260c4, "DMA1_S7M0AR"],
[0x400260c8, "DMA1_S7M1AR"],
[0x400260cc, "DMA1_S7FCR"],
[0x40026400, "DMA2_LISR"],
[0x40026404, "DMA2_HISR"],
[0x40026408, "DMA2_LIFCR"],
[0x4002640c, "DMA2_HIFCR"],
[0x40026410, "DMA2_S0CR"],
[0x40026414, "DMA2_S0NDTR"],
[0x40026418, "DMA2_S0PAR"],
[0x4002641c, "DMA2_S0M0AR"],
[0x40026420, "DMA2_S0M1AR"],
[0x40026424, "DMA2_S0FCR"],
[0x40026428, "DMA2_S1CR"],
[0x4002642c, "DMA2_S1NDTR"],
[0x40026430, "DMA2_S1PAR"],
[0x40026434, "DMA2_S1M0AR"],
[0x40026438, "DMA2_S1M1AR"],
[0x4002643c, "DMA2_S1FCR"],
[0x40026440, "DMA2_S2CR"],
[0x40026444, "DMA2_S2NDTR"],
[0x40026448, "DMA2_S2PAR"],
[0x4002644c, "DMA2_S2M0AR"],
[0x40026450, "DMA2_S2M1AR"],
[0x40026454, "DMA2_S2FCR"],
[0x40026458, "DMA2_S3CR"],
[0x4002645c, "DMA2_S3NDTR"],
[0x40026460, "DMA2_S3PAR"],
[0x40026464, "DMA2_S3M0AR"],
[0x40026468, "DMA2_S3M1AR"],
[0x4002646c, "DMA2_S3FCR"],
[0x40026470, "DMA2_S4CR"],
[0x40026474, "DMA2_S4NDTR"],
[0x40026478, "DMA2_S4PAR"],
[0x4002647c, "DMA2_S4M0AR"],
[0x40026480, "DMA2_S4M1AR"],
[0x40026484, "DMA2_S4FCR"],
[0x40026488, "DMA2_S5CR"],
[0x4002648c, "DMA2_S5NDTR"],
[0x40026490, "DMA2_S5PAR"],
[0x40026494, "DMA2_S5M0AR"],
[0x40026498, "DMA2_S5M1AR"],
[0x4002649c, "DMA2_S5FCR"],
[0x400264a0, "DMA2_S6CR"],
[0x400264a4, "DMA2_S6NDTR"],
[0x400264a8, "DMA2_S6PAR"],
[0x400264ac, "DMA2_S6M0AR"],
[0x400264b0, "DMA2_S6M1AR"],
[0x400264b4, "DMA2_S6FCR"],
[0x400264b8, "DMA2_S7CR"],
[0x400264bc, "DMA2_S7NDTR"],
[0x400264c0, "DMA2_S7PAR"],
[0x400264c4, "DMA2_S7M0AR"],
[0x400264c8, "DMA2_S7M1AR"],
[0x400264cc, "DMA2_S7FCR"],
[0x40028000, "ETH_MACCR"],
[0x40028004, "ETH_MACFFR"],
[0x40028008, "ETH_MACHTHR"],
[0x4002800c, "ETH_MACHTLR"],
[0x40028010, "ETH_MACMIIAR"],
[0x40028014, "ETH_MACMIIDR"],
[0x40028018, "ETH_MACFCR"],
[0x4002801c, "ETH_MACVLANTR"],
[0x40028028, "ETH_MACRWUFFR"],
[0x40028034, "ETH_MACDBGR"],
[0x40028038, "ETH_MACSR"],
[0x4002803c, "ETH_MACIMR"],
[0x40028040, "ETH_MACA0HR"],
[0x40028044, "ETH_MACA0LR"],
[0x40028048, "ETH_MACA1HR"],
[0x4002804c, "ETH_MACA1LR"],
[0x40028050, "ETH_MACA2HR"],
[0x40028054, "ETH_MACA2LR"],
[0x40028058, "ETH_MACA3HR"],
[0x4002805c, "ETH_MACA3LR"],
[0x40028100, "ETH_MMCCR"],
[0x40028104, "ETH_MMCRIR"],
[0x40028108, "ETH_MMCTIR"],
[0x4002810c, "ETH_MMCRIMR"],
[0x40028110, "ETH_MMCTIMR"],
[0x4002814c, "ETH_MMCTGFSCCR"],
[0x40028150, "ETH_MMCTGFMSCCR"],
[0x40028168, "ETH_MMCTGFCR"],
[0x40028194, "ETH_MMCRFCECR"],
[0x40028198, "ETH_MMCRFAECR"],
[0x400281c4, "ETH_MMCRGUFCR"],
[0x40028700, "ETH_PTPTSCR"],
[0x40028704, "ETH_PTPSSIR"],
[0x40028708, "ETH_PTPTSHR"],
[0x4002870c, "ETH_PTPTSLR"],
[0x40028710, "ETH_PTPTSHUR"],
[0x40028714, "ETH_PTPTSLUR"],
[0x40028718, "ETH_PTPTSAR"],
[0x4002871c, "ETH_PTPTTHR"],
[0x40028720, "ETH_PTPTTLR"],
[0x40028728, "ETH_PTPTSSR"],
[0x4002872c, "ETH_PTPPPSCR"],
[0x40029000, "ETH_DMABMR"],
[0x40029004, "ETH_DMATPDR"],
[0x40029008, "ETH_DMARPDR"],
[0x4002900c, "ETH_DMARDLAR"],
[0x40029010, "ETH_DMATDLAR"],
[0x40029014, "ETH_DMASR"],
[0x40029018, "ETH_DMAOMR"],
[0x4002901c, "ETH_DMAIER"],
[0x40029020, "ETH_DMAMFBOCR"],
[0x40029024, "ETH_DMARSWTR"],
[0x40029048, "ETH_DMACHTDR"],
[0x4002904c, "ETH_DMACHRDR"],
[0x40029050, "ETH_DMACHTBAR"],
[0x40029054, "ETH_DMACHRBAR"],
[0x4002b000, "DMA2D_CR"],
[0x4002b004, "DMA2D_ISR"],
[0x4002b008, "DMA2D_IFCR"],
[0x4002b014, "DMA2D_FGMAR"],
[0x4002b010, "DMA2D_FGOR"],
[0x4002b018, "DMA2D_BGOR"],
[0x4002b01c, "DMA2D_FGPFCCR"],
[0x4002b020, "DMA2D_FGCOLR"],
[0x4002b024, "DMA2D_BGPFCCR"],
[0x4002b028, "DMA2D_BGCOLR"],
[0x4002b02c, "DMA2D_FGCMAR"],
[0x4002b030, "DMA2D_BGCMAR"],
[0x4002b034, "DMA2D_OPFCCR"],
[0x4002b03c, "DMA2D_OMAR"],
[0x4002b040, "DMA2D_OOR"],
[0x4002b044, "DMA2D_NLR"],
[0x4002b048, "DMA2D_LWR"],
[0x4002b04c, "DMA2D_AMTCR"],
[0x4002b400, "DMA2D_FGCLUT"],
[0x4002b800, "DMA2D_BGCLUT"],
[0x40040000, "USB_OTG_HS"],
[0x50000000, "USB_OTG_FS"],
[0x50050000, "DCMI_CR"],
[0x50050004, "DCMI_SR"],
[0x50050008, "DCMI_RIS"],
[0x5005000c, "DCMI_IER"],
[0x50050010, "DCMI_MIS"],
[0x50050014, "DCMI_ICR"],
[0x50050018, "DCMI_ESCR"],
[0x5005001c, "DCMI_ESUR"],
[0x50050020, "DCMI_CWSTRT"],
[0x50050024, "DCMI_CWSIZE"],
[0x50050028, "DCMI_DR"],
[0x50060800, "RNG_CR"],
[0x50060804, "RNG_SR"],
[0x50060808, "RNG_DR"],
[0xe000e010, "CORTEX_SYSTICK_STK_CTRL"],
[0xe000e014, "CORTEX_SYSTICK_STK_LOAD"],
[0xe000e018, "CORTEX_SYSTICK_STK_VAL"],
[0xe000e01c, "CORTEX_SYSTICK_STK_CALIB"],
[0xe000e100, "CORTEX_NVIC_ISER0"],
[0xe000e104, "CORTEX_NVIC_ISER1"],
[0xe000e108, "CORTEX_NVIC_ISER2"],
[0xe000e180, "CORTEX_NVIC_ICER0"],
[0xe000e184, "CORTEX_NVIC_ICER1"],
[0xe000e188, "CORTEX_NVIC_ICER2"],
[0xe000e200, "CORTEX_NVIC_ISPR0"],
[0xe000e204, "CORTEX_NVIC_ISPR1"],
[0xe000e208, "CORTEX_NVIC_ISPR2"],
[0xe000e280, "CORTEX_NVIC_ICPR0"],
[0xe000e284, "CORTEX_NVIC_ICPR1"],
[0xe000e288, "CORTEX_NVIC_ICPR2"],
[0xe000e300, "CORTEX_NVIC_IABR0"],
[0xe000e304, "CORTEX_NVIC_IABR1"],
[0xe000e308, "CORTEX_NVIC_IABR2"],
[0xe000e400, "CORTEX_NVIC_IPR0"],
[0xe000e404, "CORTEX_NVIC_IPR1"],
[0xe000e408, "CORTEX_NVIC_IPR2"],
[0xe000e40c, "CORTEX_NVIC_IPR3"],
[0xe000e410, "CORTEX_NVIC_IPR4"],
[0xe000e414, "CORTEX_NVIC_IPR5"],
[0xe000e418, "CORTEX_NVIC_IPR6"],
[0xe000e41c, "CORTEX_NVIC_IPR7"],
[0xe000e420, "CORTEX_NVIC_IPR8"],
[0xe000e424, "CORTEX_NVIC_IPR9"],
[0xe000e428, "CORTEX_NVIC_IPR10"],
[0xe000e42c, "CORTEX_NVIC_IPR11"],
[0xe000e430, "CORTEX_NVIC_IPR12"],
[0xe000e434, "CORTEX_NVIC_IPR13"],
[0xe000e438, "CORTEX_NVIC_IPR14"],
[0xe000e43c, "CORTEX_NVIC_IPR15"],
[0xe000e440, "CORTEX_NVIC_IPR16"],
[0xe000e444, "CORTEX_NVIC_IPR17"],
[0xe000e448, "CORTEX_NVIC_IPR18"],
[0xe000e44c, "CORTEX_NVIC_IPR19"],
[0xe000e450, "CORTEX_NVIC_IPR20"],
[0xe000e454, "CORTEX_NVIC_IPR21"],
[0xe000e458, "CORTEX_NVIC_IPR22"],
[0xe000e45c, "CORTEX_NVIC_IPR23"],
[0xe000e460, "CORTEX_NVIC_IPR24"],
[0xe000e464, "CORTEX_NVIC_IPR25"],
[0xe000ef00, "CORTEX_NVIC_STIR"],
[0xe000ed00, "CORTEX_SCB_CPUID"],
[0xe000ed04, "CORTEX_SCB_ICSR"],
[0xe000ed08, "CORTEX_SCB_VTOR"],
[0xe000ed0c, "CORTEX_SCB_AIRCR"],
[0xe000ed10, "CORTEX_SCB_SCR"],
[0xe000ed14, "CORTEX_SCB_CCR"],
[0xe000ed18, "CORTEX_SCB_SHPR1"],
[0xe000ed1c, "CORTEX_SCB_SHPR2"],
[0xe000ed20, "CORTEX_SCB_SHPR3"],
[0xe000ed24, "CORTEX_SCB_SHCRS"],
[0xe000ed28, "CORTEX_SCB_CFSR"],
[0xe000ed2c, "CORTEX_SCB_HFSR"],
[0xe000ed34, "CORTEX_SCB_MMAR"],
[0xe000ed38, "CORTEX_SCB_BFAR"],
[0xe000ed3c, "CORTEX_SCB_AFSR"],
[0xe000ed88, "CORTEX_CPACR"],
[0xe000ed90, "CORTEX_MPU_TYPER"],
[0xe000ed94, "CORTEX_MPU_CTRL"],
[0xe000ed98, "CORTEX_MPU_RNR"],
[0xe000ed9c, "CORTEX_MPU_RBAR"],
[0xe000eda0, "CORTEX_MPU_RASR"],
[0xe000eda4, "CORTEX_MPU_RBAR_A1"],
[0xe000eda8, "CORTEX_MPU_RASR_A1"],
[0xe000edac, "CORTEX_MPU_RBAR_A2"],
[0xe000edb0, "CORTEX_MPU_RASR_A2"],
[0xe000ef34, "CORTEX_FPU_FPCCR"],
[0xe000ef38, "CORTEX_FPU_FPCAR"],
[0xe000ef3c, "CORTEX_FPU_FPDSCR"]]


def insert_iv(address, name):
    sym = createLabel(toAddr(address), name, True)
    sym.setPinned(True)
    addEntryPoint(toAddr(address))
    # Cortex interrupt vector entries are addresses of handlers
    ptr = createData(toAddr(address), ghidra.program.model.data.PointerDataType())
    # Slightly awkward to add a flow to a pointer, but this seems to work...
    createMemoryReference(ptr, ptr.getValue(), ghidra.program.model.symbol.RefType.UNCONDITIONAL_JUMP)

def insert_sp_label():
    sym = createLabel(toAddr(0), "ResetStackPointer", True)
    sym.setPinned(True)
    createData(toAddr(0), ghidra.program.model.data.PointerDataType())

def insert_mmio_label(address, name):
    sym = createLabel(toAddr(address), name, True)
    sym.setPinned(True)

def byte_map_memory_to_0(addr):
    Memory = currentProgram.getMemory()
    # Don't clobber already defined data at 0x0
    if not(Memory.getBlock(toAddr(0))):
        blk = Memory.createByteMappedBlock("boot_sel_alias", toAddr(0),
                                           toAddr(addr), 0x200000, None, False)
        blk.setRead(True)
        blk.setWrite(False)
        blk.setExecute(True)
        blk.setVolatile(False)
        blk.setComment("Byte mapped memory")

def set_flash_block_params():
    Memory = currentProgram.getMemory()
    flash_block = Memory.getBlock(toAddr(0x8000000))
    flash_block.setRead(True)
    flash_block.setWrite(False)
    flash_block.setExecute(True)
    flash_block.setVolatile(False)
    flash_block.setComment("Internal flash program memory")
    flash_block.setName("flash")

def create_mmio_memblock(name, address, size):
    Memory = currentProgram.getMemory()
    blk = Memory.createUninitializedBlock(name, toAddr(address), size, False)
    blk.setRead(True)
    blk.setWrite(True)
    blk.setExecute(False)
    blk.setVolatile(True)
    blk.setComment("Memory-mapped I/O registers")

def create_mmio_bitmapped_alias(name, region_start, alias_start, region_len):
    Memory = currentProgram.getMemory()
    blk = Memory.createBitMappedBlock(name, toAddr(alias_start),
                                      toAddr(region_start), region_len*32, False)
    blk.setRead(True)
    blk.setWrite(True)
    blk.setExecute(False)
    blk.setVolatile(True)
    blk.setComment("Bit-mapped MMIO alias")

def create_mmio_maps():
    # Regions defined in STM32F427xx STM32F429xx data sheet
    # DocID024030 Rev 10, January 2018
    # Section 5: Memory Mapping
    create_mmio_memblock("mmio1", 0x40000000, 0x8000)
    create_mmio_bitmapped_alias("mmio1_alias", 0x40000000, 0x42000000, 0x8000)
    create_mmio_memblock("mmio2", 0x40010000, 0x6c00)
    create_mmio_bitmapped_alias("mmio2_alias", 0x40010000, 0x42200000, 0x6c00)
    create_mmio_memblock("mmio3", 0x40020000, 0x60000)
    create_mmio_bitmapped_alias("mmio3_alias", 0x40020000, 0x42400000, 0x60000)
    create_mmio_memblock("mmio4", 0x50000000, 0x60c00)
    create_mmio_memblock("mmio5", 0xe0000000, 0x100000)

def create_sram_memblock(name, address, size):
    Memory = currentProgram.getMemory()
    blk = Memory.createUninitializedBlock(name, toAddr(address), size, False)
    blk.setRead(True)
    blk.setWrite(True)
    blk.setExecute(False) # Is this correct?
    blk.setVolatile(False)
    blk.setComment("SRAM")

def create_sram_bitmapped_alias(name, region_start, alias_start, region_len):
    Memory = currentProgram.getMemory()
    blk = Memory.createBitMappedBlock(name, toAddr(alias_start),
                                      toAddr(region_start), region_len*32, False)
    blk.setRead(True)
    blk.setWrite(True)
    blk.setExecute(False)
    blk.setVolatile(False)
    blk.setComment("Bit-mapped SRAM alias")

def create_sram_maps():
    # Regions defined in STM32F427xx STM32F429xx data sheet
    # DocID024030 Rev 10, January 2018
    # Section 5: Memory Mapping
    create_sram_memblock("SRAM1", 0x20000000, 0x1c000)
    create_sram_bitmapped_alias("SRAM1_alias", 0x20000000, 0x22000000, 0x1c000)
    create_sram_memblock("SRAM2", 0x2001c000, 0x4000)
    create_sram_bitmapped_alias("SRAM2_alias", 0x2001c000, 0x22380000, 0x4000)
    create_sram_memblock("SRAM3", 0x20020000, 0x10000)
    create_sram_bitmapped_alias("SRAM2_alias", 0x20020000, 0x22400000, 0x10000)

# Byte map memory region at address 0 if we defined a source
# address above
if byte_map_src_addr:
    byte_map_memory_to_0(byte_map_src_addr)

create_mmio_maps()
create_sram_maps()
set_flash_block_params()
insert_sp_label()

# Define all of the interrupt vector table entries
for IV in IVs:
    insert_iv(IV[0] + IV_base, IV[1])

for mmio_sym in mmio_syms:
    insert_mmio_label(mmio_sym[0], mmio_sym[1])

